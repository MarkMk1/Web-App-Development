<!doctype html>
<html lang="en">
 
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Project</title>
  <!-- styles -->
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans|Baumans' type='text/css'>
  <link rel="stylesheet" href="styles/reset.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="styles/main.css" type="text/css" media="screen" />
</head>
 
<body>
 <!-- Include stylesheet -->
	<link href="https://cdn.quilljs.com/1.2.5/quill.snow.css" rel="stylesheet">

	<!-- Create the editor containers -->
	<div id="editor">
	</div>
	<div id="editor2">
	</div>
	
	<div>
		<button type="button" onclick="submitButton.uploadDelta()">Sync</button>
	</div>
	

	
	<div>
		<canvas id="c" width="1280" height="800">
		</canvas>
	</div>
	
<!--	
	<div>
		<button type="button" onclick="fixButton.deltaToString()">debug</button>
	</div>
-->

	<!-- JQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	
	<!-- Quill library -->
	<script src="https://cdn.quilljs.com/1.2.5/quill.js"></script>

	<script src="http://win371.ad.utwente.nl/student/s1811185/WebAppDev/fabric.js-1.7.12/dist/fabric.js"></script>
	<!-- 
	I want to change what delta is displayed based on which object is selected in the canvas. 
	Can I do this easily without just loading the new delta over the old? 
	Can I make different instances that display based on what's selected?
	-->
	<script>
		// create a wrapper around native canvas element (with id="c")
		var canvas = new fabric.Canvas('c');
		canvas.selection = false;
		window.graphQuillActive;

		var start = new fabric.Ellipse({
		left: 10,
		top: 50,
		fill: 'pink',
		rx: 30,
		ry: 40
		});
		//Following function sets contents, and also sets a global variable
		//Which can be used to determine what delta should be overwritten when saving. 
		start.on('selected', function(){
			graphQuill.setContents(window.startDelta);
			window.graphQuillActive = "start"
		});

		
		var firstSubGoal = new fabric.Circle({
		left: 90, 
		top: 30,
		fill: 'purple', 
		radius: 20
		})
		firstSubGoal.on('selected', function() {
			graphQuill.setContents(window.firstSubGoalData);
			window.graphQuillActive = "firstSubGoal"
		});
		
		
		var secondSubGoal = new fabric.Circle({
		left: 90, 
		top: 75,
		fill: 'purple', 
		radius: 20
		})
		secondSubGoal.on('selected', function() {
			graphQuill.setContents(window.secondSubGoalData);
			window.graphQuillActive = "secondSubGoal"
		});
		
		
		var thirdSubGoal = new fabric.Circle({
		left: 90, 
		top: 120,
		fill: 'purple', 
		radius: 20
		})
		thirdSubGoal.on('selected', function() {
			graphQuill.setContents(window.thirdSubGoalData);
			window.graphQuillActive = "thirdSubGoal"
		});

		
		var firstRoughGoal = new fabric.Circle({
		left: 170, 
		top: 60,
		fill: 'pink', 
		radius: 30
		})
		firstRoughGoal.on('selected', function() {
			graphQuill.setContents(window.firstRoughGoalData);
			window.graphQuillActive = "firstRoughGoal"
		});
		
		
		var secondRoughGoal = new fabric.Circle({
		left: 330, 
		top: 60,
		fill: 'pink', 
		radius: 30
		})
		secondRoughGoal.on('selected', function() {
			graphQuill.setContents(window.secondRoughGoalData);
			window.graphQuillActive = "secondRoughGoal"
		});

		
		var end = new fabric.Ellipse({
		left: 500,
		top: 50,
		fill: 'pink',
		rx: 30,
		ry: 40
		});
		end.on('selected', function() {
			graphQuill.setContents(window.endData);
			window.graphQuillActive = "end"
		});

				
		start.set('selectable', true);
		start.set('lockMovementX', true);
		start.set('lockMovementY', true);
		start.set('lockScalingX', true);
		start.set('lockScalingY', true);
		start.set('lockUniScaling', true);
		start.set('lockRotation', true);
		
		firstSubGoal.set('lockMovementX', true);
		firstSubGoal.set('lockMovementY', true);
		firstSubGoal.set('lockScalingX', true);
		firstSubGoal.set('lockScalingY', true);
		firstSubGoal.set('lockUniScaling', true);
		firstSubGoal.set('lockRotation', true);
		
		secondSubGoal.set('lockMovementX', true);
		secondSubGoal.set('lockMovementY', true);
		secondSubGoal.set('lockScalingX', true);
		secondSubGoal.set('lockScalingY', true);
		secondSubGoal.set('lockUniScaling', true);
		secondSubGoal.set('lockRotation', true);

		thirdSubGoal.set('lockMovementX', true);
		thirdSubGoal.set('lockMovementY', true);
		thirdSubGoal.set('lockScalingX', true);
		thirdSubGoal.set('lockScalingY', true);
		thirdSubGoal.set('lockUniScaling', true);
		thirdSubGoal.set('lockRotation', true);

		firstRoughGoal.set('lockMovementX', true);
		firstRoughGoal.set('lockMovementY', true);
		firstRoughGoal.set('lockScalingX', true);
		firstRoughGoal.set('lockScalingY', true);
		firstRoughGoal.set('lockUniScaling', true);
		firstRoughGoal.set('lockRotation', true);

		secondRoughGoal.set('lockMovementX', true);
		secondRoughGoal.set('lockMovementY', true);
		secondRoughGoal.set('lockScalingX', true);
		secondRoughGoal.set('lockScalingY', true);
		secondRoughGoal.set('lockUniScaling', true);
		secondRoughGoal.set('lockRotation', true);

		end.set('lockMovementX', true);
		end.set('lockMovementY', true);
		end.set('lockScalingX', true);
		end.set('lockScalingY', true);
		end.set('lockUniScaling', true);
		end.set('lockRotation', true);
		
		canvas.add(start);
		canvas.add(firstSubGoal);
		canvas.add(secondSubGoal);
		canvas.add(thirdSubGoal);
		canvas.add(firstRoughGoal);
		canvas.add(secondRoughGoal);
		canvas.add(end);
	</script>
	
	<!-- Quill editor -->
	<script>
	  var quill = new Quill('#editor', {
		theme: 'snow'
	  });
	  var graphQuill = new Quill('#editor2', {
		theme: 'snow'
	  });
	</script> 
	
<!-- 
So I want to post the dir at the same time as the delta, 
check the dir, and treat the delta appropriately. 
How do I upload the two at once?
-->

<!--
To get the size of the JSON
-->

	<script>
		quill.setContents(mainDelta)
	</script>
	
	<script>
	var delta;
	var submitButton = {
		uploadDelta: function () {
				mainDelta = quill.getContents();
				subDelta = graphQuill.getContents();
				
//				var upScript = encodeURIComponent("http://win371.ad.utwente.nl/student/s1811185/var/www/cgi-bin/upDelta.py")
//				localStorage.setItem("upScript", upScript)
				
//				$.ajax({
//					type: 'POST',
//					url: upScript,
//					data: function(delta){return delta},
//					success: function(){
					
//					},
//				})
//				return upScript;
		}
	}
			
//	deltaSize = function(obj) {
//			var size = Object.keys(delta).length
//			return size;
//	};
//	console.log(deltaSize)
	</script>
	
<!--
	<script>
		var fixButton = {	
			deltaToString: function () {
				f = localStorage.delta.toString()
				var ret = f.contents
				localStorage.setItem("ret", ret)
				return ret;
			}
		}
	</script>
-->
	
</body>
</html>